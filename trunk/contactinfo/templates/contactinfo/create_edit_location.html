{% extends "base.html" %}

{% block title %}{% if user %}Update {{ user.get_full_name }}{% else %}Add new person{% endif %}{% endblock %}

{% block javascript %}
{{ location_form.media }}
<script type="text/javascript">
jQuery(function ($) {
    $('tbody.address_formset').change(function (e) {
        // hide the form to enter a new address if an address exists already
    	existing_fields = $('tbody.address_formset .field.existing-object').length;
        if (existing_fields > 0) {
        	$('tbody.address_formset .field.new-object').hide();
        }
    });
    $('tbody.address_formset').change();
});
</script>
{% endblock %}

{% block css %}
<link charset='UTF-8' rel='stylesheet' type='text/css' media='screen' href='{{ MEDIA_URL }}css/django-contactinfo.css' />
{% endblock %}

{% block content %}

<h2>{% if user %}Update {{ user.get_full_name }}{% else %}Add new person{% endif %}</h2>

<form id='create-edit-person' accept-charset='UTF-8' method='post' action=''>
    <table class='vertical'>
        {% include 'contactinfo/_location_form.html' %}
        
        <tbody class="form address_formset">
        {% include 'contactinfo/_address_formset.html' %}
        </tbody>
        
        <tbody class="form phone_formset">
        {% include 'contactinfo/_phone_formset.html' %}
        </tbody>
        
        <tr>
            <td>&nbsp;</td>
            <td class='submit'>
                <input type='button' value='Cancel' onclick='history.go(-1)' />
                &nbsp;
                <input type='submit' name='submit' value='{% if user %}Update{% else %}Create{% endif %} &rarr;' />
            </td>
        </tr>
    </table>
</form>

{% endblock %}
